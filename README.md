# Worm YOLOv3
An implementation of [YOLOv3](https://pjreddie.com/media/files/papers/YOLOv3.pdf) to locate and track ***C. elegans*** from experiment videos generated by the [WormBot](https://github.com/JasonNPitt/wormbot). Tracked locations are then used to make **time of death calls** and other biologically relevant metrics.

## Example
[![test](https://img.youtube.com/vi/pzxg0H6FQl4/0.jpg)](
https://youtu.be/pzxg0H6FQl4)
[(*click for video...*)](https://youtu.be/pzxg0H6FQl4)

##  Pipeline
1. `Videos exported from the experiment.`
<!-- ![RawImage](https://drive.google.com/uc?export=view&id=12lVwhj4M3lJ-vphTHwiZpAzlrpbshwtB) -->
2. `Bounding box detections are made from the videos.`
<!-- 3. ![Processed](https://drive.google.com/uc?export=view&id=1yIYDmaFXVnej_rslTmtlnQ9hPwHkFc7T) -->
3. `Death calls are made using the detections.`


---

### Docker
```bash
$ docker build
```

### Pip
* Cuda and Python Versioning.

```
    nvidia/cuda: 11.0
    python: 3.8.10
```

* Install Dependencies

```bash
$ pip install -U -r requirements.txt
$ pip install torch==1.9.1+cu111 torchvision==0.10.1+cu111 torchaudio==0.9.1 -f https://download.pytorch.org/whl/torch_stable.html
```

* Download Wieghts

```bash
$ bash weights/download_yolov3_weights.sh
```

## How to use
* download weights from google drive link in weights folder
* look at "simple_test.ipynb" to test if all dependencies are installed correctly and to see the simplest way to pass the model on images is
* note: classes.names is in cfg folder

* using csv and img options:
-- $ python3 yolov3_tracker_latest.py -h
the only arguments that you should have to set are: weights, out_path, data_path, video, csv, img
-- note: currently video doesn't work
* example
if you wanted to generate csv file from the images you'd run:
-- $ python3 yolov3_tracker_latest.py --weights %path_to_weights% --out_path %save_folder% --data_path %images_folder% --csv
* if you also wanted to generate anotated png files you would add --img to the end.


## Data Info
* approximately 1068 images 1080x1920
* 56,047 individual worms
* --csv tag saves 1 csv per image in the format: img_name, x1, y1, w, h
## Citation

 https://pjreddie.com/media/files/papers/YOLOv3.pdf

*test**


![worm](https://drive.google.com/uc?export=view&id=182g1x387z_wbBZYfqR3Ny56zVho3IV-C)